# æ•°æ®ç»“æ„åˆé›†

https://blog.csdn.net/cywosp/article/details/23397179

https://blog.csdn.net/qq_43621789/article/details/106917404

# ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•

## å“ˆå¸Œç®—æ³•å¥½åçš„å®šä¹‰
1ã€å¹³è¡¡æ€§(Balance)ï¼šå¹³è¡¡æ€§æ˜¯æŒ‡å“ˆå¸Œçš„ç»“æœèƒ½å¤Ÿå°½å¯èƒ½åˆ†å¸ƒåˆ°æ‰€æœ‰çš„ç¼“å†²ä¸­å»ï¼Œè¿™æ ·å¯ä»¥ä½¿å¾—æ‰€æœ‰çš„ç¼“å†²ç©ºé—´éƒ½å¾—åˆ°åˆ©ç”¨ã€‚å¾ˆå¤šå“ˆå¸Œç®—æ³•éƒ½èƒ½å¤Ÿæ»¡è¶³è¿™ä¸€æ¡ä»¶ã€‚

2ã€å•è°ƒæ€§(Monotonicity)ï¼šå•è°ƒæ€§æ˜¯æŒ‡å¦‚æœå·²ç»æœ‰ä¸€äº›å†…å®¹é€šè¿‡å“ˆå¸Œåˆ†æ´¾åˆ°äº†ç›¸åº”çš„ç¼“å†²ä¸­ï¼Œåˆæœ‰æ–°çš„ç¼“å†²åŠ å…¥åˆ°ç³»ç»Ÿä¸­ã€‚å“ˆå¸Œçš„ç»“æœåº”èƒ½å¤Ÿä¿è¯åŸæœ‰å·²åˆ†é…çš„å†…å®¹å¯ä»¥è¢«æ˜ å°„åˆ°åŸæœ‰çš„æˆ–è€…æ–°çš„ç¼“å†²ä¸­å»ï¼Œè€Œä¸ä¼šè¢«æ˜ å°„åˆ°æ—§çš„ç¼“å†²é›†åˆä¸­çš„å…¶ä»–ç¼“å†²åŒºã€‚Â 

3ã€åˆ†æ•£æ€§(Spread)ï¼šåœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­ï¼Œç»ˆç«¯æœ‰å¯èƒ½çœ‹ä¸åˆ°æ‰€æœ‰çš„ç¼“å†²ï¼Œè€Œæ˜¯åªèƒ½çœ‹åˆ°å…¶ä¸­çš„ä¸€éƒ¨åˆ†ã€‚å½“ç»ˆç«¯å¸Œæœ›é€šè¿‡å“ˆå¸Œè¿‡ç¨‹å°†å†…å®¹æ˜ å°„åˆ°ç¼“å†²ä¸Šæ—¶ï¼Œç”±äºä¸åŒç»ˆç«¯æ‰€è§çš„ç¼“å†²èŒƒå›´æœ‰å¯èƒ½ä¸åŒï¼Œä»è€Œå¯¼è‡´å“ˆå¸Œçš„ç»“æœä¸ä¸€è‡´ï¼Œæœ€ç»ˆçš„ç»“æœæ˜¯ç›¸åŒçš„å†…å®¹è¢«ä¸åŒçš„ç»ˆç«¯æ˜ å°„åˆ°ä¸åŒçš„ç¼“å†²åŒºä¸­ã€‚è¿™ç§æƒ…å†µæ˜¾ç„¶æ˜¯åº”è¯¥é¿å…çš„ï¼Œå› ä¸ºå®ƒå¯¼è‡´ç›¸åŒå†…å®¹è¢«å­˜å‚¨åˆ°ä¸åŒç¼“å†²ä¸­å»ï¼Œé™ä½äº†ç³»ç»Ÿå­˜å‚¨çš„æ•ˆç‡ã€‚åˆ†æ•£æ€§çš„å®šä¹‰å°±æ˜¯ä¸Šè¿°æƒ…å†µå‘ç”Ÿçš„ä¸¥é‡ç¨‹åº¦ã€‚å¥½çš„å“ˆå¸Œç®—æ³•åº”èƒ½å¤Ÿå°½é‡é¿å…ä¸ä¸€è‡´çš„æƒ…å†µå‘ç”Ÿï¼Œä¹Ÿå°±æ˜¯å°½é‡é™ä½åˆ†æ•£æ€§ã€‚Â 

4ã€è´Ÿè½½(Load)ï¼šè´Ÿè½½é—®é¢˜å®é™…ä¸Šæ˜¯ä»å¦ä¸€ä¸ªè§’åº¦çœ‹å¾…åˆ†æ•£æ€§é—®é¢˜ã€‚æ—¢ç„¶ä¸åŒçš„ç»ˆç«¯å¯èƒ½å°†ç›¸åŒçš„å†…å®¹æ˜ å°„åˆ°ä¸åŒçš„ç¼“å†²åŒºä¸­ï¼Œé‚£ä¹ˆå¯¹äºä¸€ä¸ªç‰¹å®šçš„ç¼“å†²åŒºè€Œè¨€ï¼Œä¹Ÿå¯èƒ½è¢«ä¸åŒçš„ç”¨æˆ·æ˜ å°„ä¸ºä¸åŒ çš„å†…å®¹ã€‚ä¸åˆ†æ•£æ€§ä¸€æ ·ï¼Œè¿™ç§æƒ…å†µä¹Ÿæ˜¯åº”å½“é¿å…çš„ï¼Œå› æ­¤å¥½çš„å“ˆå¸Œç®—æ³•åº”èƒ½å¤Ÿå°½é‡é™ä½ç¼“å†²çš„è´Ÿè·ã€‚

## ä¸ºä»€ä¹ˆéœ€è¦ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•ï¼Ÿ

Hashç®—æ³•è§£å†³çš„æ˜¯é›†ç¾¤ç®¡ç†ä¸­è¯·æ±‚è®¿é—®çš„è·¯ç”±çš„é—®é¢˜,ä¸€èˆ¬æ˜¯æ ¹æ®ä¸€ä¸ªè¯·æ±‚çš„æŸä¸ªkeyå€¼å–ä½™,è·¯ç”±åˆ°ç›¸åº”çš„æœåŠ¡å™¨,æ¯”å¦‚,Keyçš„hashCodeæ˜¯52,æœåŠ¡å™¨çš„æ•°ç›®æ˜¯3,å–ä½™ä¹‹åä¸º1,åˆ™è¯¥keyå¯¹åº”çš„èŠ‚ç‚¹æ˜¯Node1,ç”±äºHashCodeéšæœºæ€§æ¯”è¾ƒå¼ºï¼Œæ‰€ä»¥ä½¿ç”¨ä½™æ•°Hashè·¯ç”±ç®—æ³•å°±å¯ä»¥ä¿è¯ç¼“å­˜æ•°æ®åœ¨æ•´ä¸ªç¼“å­˜æœåŠ¡å™¨é›†ç¾¤ä¸­æœ‰æ¯”è¾ƒå‡è¡¡çš„åˆ†å¸ƒ,è¿™å°±æ˜¯ä½™æ•°Hashçš„ç®—æ³•,==ä½†æ˜¯è¿™ç§ç®—æ³•ä¼šæœ‰ä¸€ä¸ªé—®é¢˜å°±æ˜¯é›†ç¾¤æ‰©å®¹äº†æˆ–è€…æœåŠ¡å™¨ä¸‹çº¿äº†,é‚£ä¹ˆå–ä½™çš„æ–¹å¼,åŸæ¥Keyæ˜ å°„åˆ°èŠ‚ç‚¹å¯èƒ½ä¸ä¼šæ˜¯Node1,å¯èƒ½ä¼šå¯¼è‡´æŸä¸ªèŠ‚ç‚¹çš„è¯·æ±‚å‹åŠ›å˜å¤§,ä¸€è‡´æ€§å“ˆå¸Œè§£å†³äº†æ™®é€šä½™æ•°Hashç®—æ³•ä¼¸ç¼©æ€§å·®çš„é—®é¢˜ï¼Œå¯ä»¥ä¿è¯åœ¨ä¸Šçº¿ã€ä¸‹çº¿æœåŠ¡å™¨çš„æƒ…å†µä¸‹å°½é‡æœ‰å¤šçš„è¯·æ±‚å‘½ä¸­åŸæ¥è·¯ç”±åˆ°çš„æœåŠ¡å™¨ã€‚==

### ç¯å½¢Hashç©ºé—´

æŒ‰ç…§å¸¸ç”¨çš„hashç®—æ³•æ¥å°†å¯¹åº”çš„keyå“ˆå¸Œåˆ°ä¸€ä¸ªå…·æœ‰2^32æ¬¡æ–¹ä¸ªæ¡¶çš„ç©ºé—´ä¸­ï¼Œå³0~(2^32)-1çš„æ•°å­—ç©ºé—´ä¸­ã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥å°†è¿™äº›æ•°å­—å¤´å°¾ç›¸è¿ï¼Œæƒ³è±¡æˆä¸€ä¸ªé—­åˆçš„ç¯å½¢ã€‚å¦‚ä¸‹å›¾

![](https://gitee.com/super-jimwang/img/raw/master/img/20210330205552.png)



==ä¸ºä»€ä¹ˆæ˜¯2^32ä¸ªæ¡¶ç©ºé—´ï¼Ÿ==
- å½“hashæ˜¯ä¸€ä¸ª32ä½æ— ç¬¦å·æ•´å‹æ—¶ï¼Œå°±æ˜¯2^32ï¼Œå¦‚æœç”¨64ä½ï¼Œé‚£å°±æ˜¯2^64

**æŠŠæ•°æ®é€šè¿‡ä¸€å®šçš„hashç®—æ³•å¤„ç†åæ˜ å°„åˆ°ç¯ä¸Š**

ç°åœ¨æˆ‘ä»¬å°†object1ã€object2ã€object3ã€object4å››ä¸ªå¯¹è±¡é€šè¿‡ç‰¹å®šçš„Hashå‡½æ•°è®¡ç®—å‡ºå¯¹åº”çš„keyå€¼ï¼Œç„¶åæ•£åˆ—åˆ°Hashç¯ä¸Šã€‚å¦‚ä¸‹å›¾ï¼š
- Hash(object1) = key1ï¼›
- Hash(object2) = key2ï¼›
- Hash(object3) = key3ï¼›
- Hash(object4) = key4ï¼›

![](https://gitee.com/super-jimwang/img/raw/master/img/20210330205841.png)


**å°†æœºå™¨é€šè¿‡hashç®—æ³•æ˜ å°„åˆ°ç¯ä¸Š**

åœ¨é‡‡ç”¨ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•çš„åˆ†å¸ƒå¼é›†ç¾¤ä¸­å°†æ–°çš„æœºå™¨åŠ å…¥ï¼Œå…¶åŸç†æ˜¯é€šè¿‡ä½¿ç”¨ä¸å¯¹è±¡å­˜å‚¨ä¸€æ ·çš„Hashç®—æ³•å°†æœºå™¨ä¹Ÿæ˜ å°„åˆ°ç¯ä¸­ï¼ˆä¸€èˆ¬æƒ…å†µä¸‹å¯¹æœºå™¨çš„hashè®¡ç®—æ˜¯é‡‡ç”¨æœºå™¨çš„IPæˆ–è€…æœºå™¨å”¯ä¸€çš„åˆ«åä½œä¸ºè¾“å…¥å€¼ï¼‰ï¼Œç„¶åä»¥é¡ºæ—¶é’ˆçš„æ–¹å‘è®¡ç®—ï¼Œå°†æ‰€æœ‰å¯¹è±¡å­˜å‚¨åˆ°ç¦»è‡ªå·±æœ€è¿‘çš„æœºå™¨ä¸­ã€‚

å‡è®¾ç°åœ¨æœ‰NODE1ï¼ŒNODE2ï¼ŒNODE3ä¸‰å°æœºå™¨ï¼Œé€šè¿‡Hashç®—æ³•å¾—åˆ°å¯¹åº”çš„KEYå€¼ï¼Œæ˜ å°„åˆ°ç¯ä¸­ï¼Œå…¶ç¤ºæ„å›¾å¦‚ä¸‹ï¼š
- Hash(NODE1) = KEY1;
- Hash(NODE2) = KEY2;
- Hash(NODE3) = KEY3;

![](https://gitee.com/super-jimwang/img/raw/master/img/20210330205925.png)

==æ­¤å›¾æ˜¯æœ€ç†æƒ³çš„æƒ…å†µï¼Œä¸‰ä¸ªç‚¹æ­£å¥½å‡åŒ€åˆ†å¸ƒ==

é€šè¿‡ä¸Šå›¾å¯ä»¥çœ‹å‡º==å¯¹è±¡ä¸æœºå™¨å¤„äºåŒä¸€å“ˆå¸Œç©ºé—´ä¸­==ï¼Œè¿™æ ·==æŒ‰é¡ºæ—¶é’ˆè½¬åŠ¨object1å­˜å‚¨åˆ°äº†NODE1ä¸­ï¼Œobject3å­˜å‚¨åˆ°äº†NODE2ä¸­ï¼Œobject2ã€object4å­˜å‚¨åˆ°äº†NODE3ä¸­ã€‚==åœ¨è¿™æ ·çš„éƒ¨ç½²ç¯å¢ƒä¸­ï¼Œhashç¯æ˜¯ä¸ä¼šå˜æ›´çš„ï¼Œå› æ­¤ï¼Œé€šè¿‡ç®—å‡ºå¯¹è±¡çš„hashå€¼å°±èƒ½å¿«é€Ÿçš„å®šä½åˆ°å¯¹åº”çš„æœºå™¨ä¸­ï¼Œè¿™æ ·å°±èƒ½æ‰¾åˆ°å¯¹è±¡çœŸæ­£çš„å­˜å‚¨ä½ç½®äº†ã€‚

### æœºå™¨çš„åˆ é™¤ä¸æ·»åŠ 
æ™®é€šhashæ±‚ä½™ç®—æ³•æœ€ä¸ºä¸å¦¥çš„åœ°æ–¹å°±æ˜¯åœ¨æœ‰æœºå™¨çš„æ·»åŠ æˆ–è€…åˆ é™¤ä¹‹åä¼šç…§æˆå¤§é‡çš„å¯¹è±¡å­˜å‚¨ä½ç½®å¤±æ•ˆï¼Œè¿™æ ·å°±å¤§å¤§çš„ä¸æ»¡è¶³å•è°ƒæ€§äº†ã€‚ä¸‹é¢æ¥åˆ†æä¸€ä¸‹ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•æ˜¯å¦‚ä½•å¤„ç†çš„ã€‚

**1. èŠ‚ç‚¹ï¼ˆæœºå™¨ï¼‰çš„åˆ é™¤**

ä»¥ä¸Šé¢çš„åˆ†å¸ƒä¸ºä¾‹ï¼Œå¦‚æœNODE2å‡ºç°æ•…éšœè¢«åˆ é™¤äº†ï¼Œé‚£ä¹ˆæŒ‰ç…§é¡ºæ—¶é’ˆè¿ç§»çš„æ–¹æ³•ï¼Œobject3å°†ä¼šè¢«è¿ç§»åˆ°NODE3ä¸­ï¼Œè¿™æ ·ä»…ä»…æ˜¯object3çš„æ˜ å°„ä½ç½®å‘ç”Ÿäº†å˜åŒ–ï¼Œå…¶å®ƒçš„å¯¹è±¡æ²¡æœ‰ä»»ä½•çš„æ”¹åŠ¨ã€‚å¦‚ä¸‹å›¾ï¼š

![](https://gitee.com/super-jimwang/img/raw/master/img/20210330210054.png)

==å¦‚æœä½¿ç”¨ä¹‹å‰çš„hashç®—æ³•ï¼ŒæœåŠ¡å™¨æ•°é‡å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰€æœ‰æœåŠ¡å™¨çš„æ‰€æœ‰ç¼“å­˜åœ¨åŒä¸€æ—¶é—´å¤±æ•ˆäº†ï¼Œè€Œä½¿ç”¨ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•æ—¶ï¼ŒæœåŠ¡å™¨çš„æ•°é‡å¦‚æœå‘ç”Ÿæ”¹å˜ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰ç¼“å­˜éƒ½ä¼šå¤±æ•ˆï¼Œè€Œæ˜¯åªæœ‰éƒ¨åˆ†ç¼“å­˜ä¼šå¤±æ•ˆï¼Œå‰ç«¯çš„ç¼“å­˜ä»ç„¶èƒ½åˆ†æ‹…æ•´ä¸ªç³»ç»Ÿçš„å‹åŠ›ï¼Œè€Œä¸è‡³äºæ‰€æœ‰å‹åŠ›éƒ½åœ¨åŒä¸€æ—¶é—´é›†ä¸­åˆ°åç«¯æœåŠ¡å™¨ä¸Šã€‚==

**2. èŠ‚ç‚¹ï¼ˆæœºå™¨ï¼‰çš„æ·»åŠ **

å¦‚æœå¾€é›†ç¾¤ä¸­æ·»åŠ ä¸€ä¸ªæ–°çš„èŠ‚ç‚¹NODE4ï¼Œé€šè¿‡å¯¹åº”çš„å“ˆå¸Œç®—æ³•å¾—åˆ°KEY4ï¼Œå¹¶æ˜ å°„åˆ°ç¯ä¸­ï¼Œå¦‚ä¸‹å›¾ï¼š

![](https://gitee.com/super-jimwang/img/raw/master/img/20210330210202.png)

é€šè¿‡æŒ‰é¡ºæ—¶é’ˆè¿ç§»çš„è§„åˆ™ï¼Œé‚£ä¹ˆobject2è¢«è¿ç§»åˆ°äº†NODE4ä¸­ï¼Œå…¶å®ƒå¯¹è±¡è¿˜ä¿æŒè¿™åŸæœ‰çš„å­˜å‚¨ä½ç½®ã€‚é€šè¿‡å¯¹èŠ‚ç‚¹çš„æ·»åŠ å’Œåˆ é™¤çš„åˆ†æï¼Œä¸€è‡´æ€§å“ˆå¸Œç®—æ³•åœ¨ä¿æŒäº†å•è°ƒæ€§çš„åŒæ—¶ï¼Œè¿˜æ˜¯æ•°æ®çš„è¿ç§»è¾¾åˆ°äº†æœ€å°ï¼Œè¿™æ ·çš„ç®—æ³•å¯¹åˆ†å¸ƒå¼é›†ç¾¤æ¥è¯´æ˜¯éå¸¸åˆé€‚çš„ï¼Œé¿å…äº†å¤§é‡æ•°æ®è¿ç§»ï¼Œå‡å°äº†æœåŠ¡å™¨çš„çš„å‹åŠ›ã€‚

==æ³¨æ„ï¼Œä¸Šé¢ä¸¤ç§æƒ…å†µèŠ‚ç‚¹çš„åˆ†å¸ƒä¸å¹³å‡äº†ï¼Œä¼šå¯¼è‡´æŸä¸€å°æœåŠ¡å™¨çš„æ•°æ®é‡è¿‡å¤š==

#### å¹³è¡¡æ€§

æ ¹æ®ä¸Šé¢çš„å›¾è§£åˆ†æï¼Œä¸€è‡´æ€§å“ˆå¸Œç®—æ³•æ»¡è¶³äº†å•è°ƒæ€§å’Œè´Ÿè½½å‡è¡¡çš„ç‰¹æ€§ä»¥åŠä¸€èˆ¬hashç®—æ³•çš„åˆ†æ•£æ€§ï¼Œä½†è¿™è¿˜å¹¶ä¸èƒ½å½“åšå…¶è¢«å¹¿æ³›åº”ç”¨çš„åŸç”±ï¼Œå› ä¸ºè¿˜ç¼ºå°‘äº†å¹³è¡¡æ€§ã€‚ä¸‹é¢å°†åˆ†æä¸€è‡´æ€§å“ˆå¸Œç®—æ³•æ˜¯å¦‚ä½•æ»¡è¶³å¹³è¡¡æ€§çš„ã€‚==hashç®—æ³•æ˜¯ä¸ä¿è¯å¹³è¡¡çš„ï¼Œå¦‚ä¸Šé¢åªéƒ¨ç½²äº†NODE1å’ŒNODE3çš„æƒ…å†µï¼ˆNODE2è¢«åˆ é™¤çš„å›¾ï¼‰ï¼Œobject1å­˜å‚¨åˆ°äº†NODE1ä¸­ï¼Œè€Œobject2ã€object3ã€object4éƒ½å­˜å‚¨åˆ°äº†NODE3ä¸­ï¼Œè¿™æ ·å°±ç…§æˆäº†éå¸¸ä¸å¹³è¡¡çš„çŠ¶æ€ã€‚==åœ¨ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•ä¸­ï¼Œä¸ºäº†å°½å¯èƒ½çš„æ»¡è¶³å¹³è¡¡æ€§ï¼Œå…¶å¼•å…¥äº†è™šæ‹ŸèŠ‚ç‚¹ã€‚

- ==â€œè™šæ‹ŸèŠ‚ç‚¹â€ï¼ˆ virtual node ï¼‰æ˜¯å®é™…èŠ‚ç‚¹ï¼ˆæœºå™¨ï¼‰åœ¨ hash ç©ºé—´çš„å¤åˆ¶å“ï¼ˆ replica ï¼‰ï¼Œä¸€å®é™…ä¸ªèŠ‚ç‚¹ï¼ˆæœºå™¨ï¼‰å¯¹åº”äº†è‹¥å¹²ä¸ªâ€œè™šæ‹ŸèŠ‚ç‚¹â€ï¼Œè¿™ä¸ªå¯¹åº”ä¸ªæ•°ä¹Ÿæˆä¸ºâ€œå¤åˆ¶ä¸ªæ•°â€ï¼Œâ€œè™šæ‹ŸèŠ‚ç‚¹â€åœ¨ hash ç©ºé—´ä¸­ä»¥hashå€¼æ’åˆ—ã€‚==

![](https://gitee.com/super-jimwang/img/raw/master/img/20210330210411.png)

æ ¹æ®ä¸Šå›¾å¯çŸ¥å¯¹è±¡çš„æ˜ å°„å…³ç³»ï¼šobject1->NODE1-1ï¼Œobject2->NODE1-2ï¼Œobject3->NODE3-2ï¼Œobject4->NODE3-1ã€‚é€šè¿‡è™šæ‹ŸèŠ‚ç‚¹çš„å¼•å…¥ï¼Œå¯¹è±¡çš„åˆ†å¸ƒå°±æ¯”è¾ƒå‡è¡¡äº†ã€‚

==â€œè™šæ‹ŸèŠ‚ç‚¹â€çš„hashè®¡ç®—å¯ä»¥é‡‡ç”¨å¯¹åº”èŠ‚ç‚¹çš„IPåœ°å€åŠ æ•°å­—åç¼€çš„æ–¹å¼ã€‚ä¾‹å¦‚å‡è®¾NODE1çš„IPåœ°å€ä¸º192.168.1.100ã€‚å¼•å…¥â€œè™šæ‹ŸèŠ‚ç‚¹â€å‰ï¼Œè®¡ç®— cache A çš„ hash å€¼ï¼š==
Hash(â€œ192.168.1.100â€);
å¼•å…¥â€œè™šæ‹ŸèŠ‚ç‚¹â€åï¼Œè®¡ç®—â€œè™šæ‹ŸèŠ‚â€ç‚¹NODE1-1å’ŒNODE1-2çš„hashå€¼ï¼š
Hash(â€œ192.168.1.100#1â€); // NODE1-1
Hash(â€œ192.168.1.100#2â€); // NODE1-2

==è™šæ‹ŸèŠ‚ç‚¹è¶Šå¤šï¼Œhashç¯ä¸Šçš„èŠ‚ç‚¹å°±è¶Šå¤šï¼Œç¼“å­˜è¢«å‡åŒ€åˆ†å¸ƒçš„æ¦‚ç‡å°±è¶Šå¤§ã€‚==

# å…«å¤§æ’åºä»¥åŠjavaå®ç°

## æ’å…¥æ’åº

### ç®—æ³•æè¿°

ä¸€èˆ¬æ¥è¯´ï¼Œæ’å…¥æ’åºéƒ½é‡‡ç”¨in-placeåœ¨æ•°ç»„ä¸Šå®ç°ã€‚å…·ä½“ç®—æ³•æè¿°å¦‚ä¸‹ï¼š

1. ä»ç¬¬ä¸€ä¸ªå…ƒç´ å¼€å§‹ï¼Œè¯¥å…ƒç´ å¯ä»¥è®¤ä¸ºå·²ç»è¢«æ’åº
2. å–å‡ºä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œåœ¨å·²ç»æ’åºçš„å…ƒç´ åºåˆ—ä¸­ä»åå‘å‰æ‰«æ
3. å¦‚æœè¯¥å…ƒç´ ï¼ˆå·²æ’åºï¼‰å¤§äºæ–°å…ƒç´ ï¼Œå°†è¯¥å…ƒç´ ç§»åˆ°ä¸‹ä¸€ä½ç½®
4. é‡å¤æ­¥éª¤3ï¼Œç›´åˆ°æ‰¾åˆ°å·²æ’åºçš„å…ƒç´ å°äºæˆ–è€…ç­‰äºæ–°å…ƒç´ çš„ä½ç½®
5. å°†æ–°å…ƒç´ æ’å…¥åˆ°è¯¥ä½ç½®å
6. é‡å¤æ­¥éª¤2~5

![img](https://gitee.com/super-jimwang/img/raw/master/img/20210217202351.gif)

```java
public int[] sort(int[] nums) {
  int len = nums.length;
  for(int i = 1; i < len; i++) {
    int n = nums[i];
    for(int j = i; j>0 && n<nums[j-1]; j--) {
			nums[j] = nums[j-1];
    }
    nums[j] = n;
  }
  return nums;
}
```

ç›´æ¥æ’å…¥æ’åºå¤æ‚åº¦å¦‚ä¸‹ï¼š

| å¹³å‡æ—¶é—´å¤æ‚åº¦ | æœ€å¥½æƒ…å†µ | æœ€åæƒ…å†µ | ç©ºé—´å¤æ‚åº¦ | ç¨³å®šæ€§ |
| -------------- | -------- | -------- | ---------- | ------ |
| O(nÂ²)          | O(nÂ²)    | O(nÂ²)    | O(1)       | ç¨³å®š   |

## é€‰æ‹©æ’åº

### ç®—æ³•æè¿°

1. ä»æœªæ’åºåºåˆ—ä¸­ï¼Œæ‰¾åˆ°å…³é”®å­—æœ€å°çš„å…ƒç´ 
2. å¦‚æœæœ€å°å…ƒç´ ä¸æ˜¯æœªæ’åºåºåˆ—çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå°†å…¶å’Œæœªæ’åºåºåˆ—ç¬¬ä¸€ä¸ªå…ƒç´ äº’æ¢
3. é‡å¤1ã€2æ­¥ï¼Œç›´åˆ°æ’åºç»“æŸã€‚

![img](https://gitee.com/super-jimwang/img/raw/master/img/20210218172932.gif)

```java
public int[] sort(int[] nums) {
    int len = nums.length;
        for(int i = 0; i < len; i++) {
            int min = i;
            for(int j = i + 1; j < len; j++) {
                    if(nums[j] < nums[min]) {
                        min = j;
                    }
            }
            int tmp = nums[i];
            nums[i] = nums[min];
            nums[min] = tmp;
        }
        return nums;
}
```

| å¹³å‡æ—¶é—´å¤æ‚åº¦ | æœ€å¥½æƒ…å†µ | æœ€åæƒ…å†µ | ç©ºé—´å¤æ‚åº¦ | ç¨³å®šæ€§ |
| -------------- | -------- | -------- | ---------- | ------ |
| O(nÂ²)          | O(nÂ²)    | O(nÂ²)    | O(1)       | ä¸ç¨³å®š |

## å†’æ³¡æ’åº

### ç®—æ³•æè¿°

å†’æ³¡æ’åºç®—æ³•çš„è¿ä½œå¦‚ä¸‹ï¼š

1. æ¯”è¾ƒç›¸é‚»çš„å…ƒç´ ã€‚å¦‚æœç¬¬ä¸€ä¸ªæ¯”ç¬¬äºŒä¸ªå¤§ï¼Œå°±äº¤æ¢ä»–ä»¬ä¸¤ä¸ªã€‚
2. å¯¹æ¯ä¸€å¯¹ç›¸é‚»å…ƒç´ ä½œåŒæ ·çš„å·¥ä½œï¼Œä»å¼€å§‹ç¬¬ä¸€å¯¹åˆ°ç»“å°¾çš„æœ€åä¸€å¯¹ã€‚è¿™æ­¥åšå®Œåï¼Œæœ€åçš„å…ƒç´ ä¼šæ˜¯æœ€å¤§çš„æ•°ã€‚
3. é’ˆå¯¹æ‰€æœ‰çš„å…ƒç´ é‡å¤ä»¥ä¸Šçš„æ­¥éª¤ï¼Œé™¤äº†æœ€åä¸€ä¸ªã€‚
4. æŒç»­æ¯æ¬¡å¯¹è¶Šæ¥è¶Šå°‘çš„å…ƒç´ é‡å¤ä¸Šé¢çš„æ­¥éª¤ï¼Œç›´åˆ°æ²¡æœ‰ä»»ä½•ä¸€å¯¹æ•°å­—éœ€è¦æ¯”è¾ƒã€‚

![img](https://images.morethink.cn/bubble.gif)

```java
public int[] sortArray(int[] nums) {
        int len = nums.length;
        for(int i = 0; i < len; i++) {
            for(int j = 0; j < len-i-1; j++) {
                    if(nums[j] > nums[j+1]) {
                        int tmp = nums[j];
                        nums[j] = nums[j+1];
                        nums[j+1] = tmp;
                    }
            }
        }
        return nums;
    }
```
æ”¹è¿›çš„å†’æ³¡æ’åºæœ€å¥½æƒ…å†µå¯ä»¥åšåˆ°O(n)ï¼Œå°±æ˜¯éå†äº†ä¸€æ¬¡å‘ç°å…¨éƒ¨æœ‰åºï¼Œåˆ™æ— éœ€åœ¨å¤šå‡ è½®äº†
| å¹³å‡æ—¶é—´å¤æ‚åº¦ | æœ€å¥½æƒ…å†µ | æœ€åæƒ…å†µ | ç©ºé—´å¤æ‚åº¦ | ç¨³å®šæ€§ |
| -------------- | -------- | -------- | ---------- | ------ |
| O(nÂ²)          | O(n)     | O(nÂ²)    | O(1)       | ç¨³å®š   |

## å¿«é€Ÿæ’åº

### ç®—æ³•æè¿°

å¿«é€Ÿæ’åºä½¿ç”¨åˆ†æ²»ç­–ç•¥æ¥æŠŠä¸€ä¸ªåºåˆ—ï¼ˆlistï¼‰åˆ†ä¸ºä¸¤ä¸ªå­åºåˆ—ï¼ˆsub-listsï¼‰ã€‚æ­¥éª¤ä¸ºï¼š

1. ä»æ•°åˆ—ä¸­æŒ‘å‡ºä¸€ä¸ªå…ƒç´ ï¼Œç§°ä¸º"åŸºå‡†"ï¼ˆpivotï¼‰ã€‚
2. é‡æ–°æ’åºæ•°åˆ—ï¼Œæ‰€æœ‰æ¯”åŸºå‡†å€¼å°çš„å…ƒç´ æ‘†æ”¾åœ¨åŸºå‡†å‰é¢ï¼Œæ‰€æœ‰æ¯”åŸºå‡†å€¼å¤§çš„å…ƒç´ æ‘†åœ¨åŸºå‡†åé¢ï¼ˆç›¸åŒçš„æ•°å¯ä»¥åˆ°ä»»ä¸€è¾¹ï¼‰ã€‚åœ¨è¿™ä¸ªåˆ†åŒºç»“æŸä¹‹åï¼Œè¯¥åŸºå‡†å°±å¤„äºæ•°åˆ—çš„ä¸­é—´ä½ç½®ã€‚è¿™ä¸ªç§°ä¸ºåˆ†åŒºï¼ˆpartitionï¼‰æ“ä½œã€‚
3. é€’å½’åœ°ï¼ˆrecursivelyï¼‰æŠŠå°äºåŸºå‡†å€¼å…ƒç´ çš„å­æ•°åˆ—å’Œå¤§äºåŸºå‡†å€¼å…ƒç´ çš„å­æ•°åˆ—æ’åºã€‚

é€’å½’åˆ°æœ€åº•éƒ¨æ—¶ï¼Œæ•°åˆ—çš„å¤§å°æ˜¯é›¶æˆ–ä¸€ï¼Œä¹Ÿå°±æ˜¯å·²ç»æ’åºå¥½äº†ã€‚è¿™ä¸ªç®—æ³•ä¸€å®šä¼šç»“æŸï¼Œå› ä¸ºåœ¨æ¯æ¬¡çš„è¿­ä»£ï¼ˆiterationï¼‰ä¸­ï¼Œå®ƒè‡³å°‘ä¼šæŠŠä¸€ä¸ªå…ƒç´ æ‘†åˆ°å®ƒæœ€åçš„ä½ç½®å»ã€‚

![img](https://gitee.com/super-jimwang/img/raw/master/img/20210218173618.gif)

```java
public void fastSort(int[] a, int lo, int hi) {
        if (lo >= hi) {
            return;
        }
        int left = lo;
        int right = hi;

        //ä¿å­˜åŸºå‡†å€¼
        int pivot = a[left];
        while (left < right) {
            //ä»åå‘å‰æ‰¾åˆ°æ¯”åŸºå‡†å°çš„å…ƒç´ 
            while (left < right && a[right] >= pivot)
                right--;
            a[left] = a[right];
            //ä»å‰å¾€åæ‰¾åˆ°æ¯”åŸºå‡†å¤§çš„å…ƒç´ 
            while (left < right && a[left] <= pivot)
                left++;
            a[right] = a[left];
        }
        // æ”¾ç½®åŸºå‡†å€¼ï¼Œå‡†å¤‡åˆ†æ²»é€’å½’å¿«æ’
        a[left] = pivot;
        fastSort(a, lo, left - 1);
        fastSort(a, left + 1, hi);
    }
```

ä»¥ä¸‹æ˜¯å¿«é€Ÿæ’åºç®—æ³•å¤æ‚åº¦:

| å¹³å‡æ—¶é—´å¤æ‚åº¦ | æœ€å¥½æƒ…å†µ  | æœ€åæƒ…å†µ | ç©ºé—´å¤æ‚åº¦ | ç¨³å®šæ€§ |
| -------------- | --------- | -------- | ---------- | ------ |
| O(nlogâ‚‚n)      | O(nlogâ‚‚n) | O(nÂ²)    | O(1)       | ä¸ç¨³å®š |

## å½’å¹¶æ’åº

### ç®—æ³•æè¿°

1. å°†åºåˆ—æ¯ç›¸é‚»ä¸¤ä¸ªæ•°å­—è¿›è¡Œå½’å¹¶æ“ä½œï¼Œå½¢æˆ floor(n/2)ä¸ªåºåˆ—ï¼Œæ’åºåæ¯ä¸ªåºåˆ—åŒ…å«ä¸¤ä¸ªå…ƒç´ ï¼›
2. å°†ä¸Šè¿°åºåˆ—å†æ¬¡å½’å¹¶ï¼Œå½¢æˆ floor(n/4)ä¸ªåºåˆ—ï¼Œæ¯ä¸ªåºåˆ—åŒ…å«å››ä¸ªå…ƒç´ ï¼›
3. é‡å¤æ­¥éª¤2ï¼Œç›´åˆ°æ‰€æœ‰å…ƒç´ æ’åºå®Œæ¯•ã€‚

![img](https://gitee.com/super-jimwang/img/raw/master/img/20210218193935.gif)

ä»¥ä¸‹æ˜¯å½’å¹¶æ’åºç®—æ³•å¤æ‚åº¦:

| å¹³å‡æ—¶é—´å¤æ‚åº¦ | æœ€å¥½æƒ…å†µ  | æœ€åæƒ…å†µ  | ç©ºé—´å¤æ‚åº¦ | ç¨³å®šæ€§ |
| -------------- | --------- | --------- | ---------- | ------ |
| O(nlogâ‚‚n)      | O(nlogâ‚‚n) | O(nlogâ‚‚n) | O(n)       | ç¨³å®š   |

## å †æ’åº

### ç®—æ³•æè¿°

1. å…ˆå°†åˆå§‹åºåˆ—ğ¾[1..ğ‘›]å»ºæˆä¸€ä¸ªå¤§é¡¶å †, é‚£ä¹ˆæ­¤æ—¶ç¬¬ä¸€ä¸ªå…ƒç´ ğ¾1æœ€å¤§, æ­¤å †ä¸ºåˆå§‹çš„æ— åºåŒº.
2. å†å°†å…³é”®å­—æœ€å¤§çš„è®°å½•ğ¾1 (å³å †é¡¶, ç¬¬ä¸€ä¸ªå…ƒç´ )å’Œæ— åºåŒºçš„æœ€åä¸€ä¸ªè®°å½• ğ¾ğ‘› äº¤æ¢, ç”±æ­¤å¾—åˆ°æ–°çš„æ— åºåŒºğ¾[1..ğ‘›âˆ’1]å’Œæœ‰åºåŒºğ¾[ğ‘›], ä¸”æ»¡è¶³ğ¾[1..ğ‘›âˆ’1].ğ‘˜ğ‘’ğ‘¦ğ‘ â©½ğ¾[ğ‘›].ğ‘˜ğ‘’ğ‘¦
3. äº¤æ¢ğ¾1 å’Œ ğ¾ğ‘› å, å †é¡¶å¯èƒ½è¿åå †æ€§è´¨, å› æ­¤éœ€å°†ğ¾[1..ğ‘›âˆ’1]è°ƒæ•´ä¸ºå †. ç„¶åé‡å¤æ­¥éª¤2, ç›´åˆ°æ— åºåŒºåªæœ‰ä¸€ä¸ªå…ƒç´ æ—¶åœæ­¢ã€‚

```java
public int[] sortArray(int[] nums) {
  for(int i = nums.length-1; i>0;i--) {
    // æ¯æ¬¡éƒ½é‡æ–°æ„å»ºä¸€æ¬¡å †
    max_heapify(nums, i);

    // å°†å †é¡¶æ”¾åˆ°æœ€åï¼Œè¡¨ç¤ºå·²ç»ç¡®å®šæ’åºäº†
    int tmp = nums[0];
    nums[0] = nums[i];
    nums[i] = tmp;
  }
  return nums;
}
public void max_heapify(int[] nums, int f) {
  int child;
  // éå†æ‰€æœ‰çˆ¶èŠ‚ç‚¹
  for(int i = (f-1)/2;i>=0;i--) {
    child = i*2+1;
    if(child!=f && nums[child+1]>nums[child]) {
      child++;
    }
    // å¦‚æœçˆ¶èŠ‚ç‚¹æ¯”æœ€å¤§çš„å­èŠ‚ç‚¹å°å°±äº¤æ¢ã€‚
    if(nums[i]<nums[child]) {
      int tmp = nums[i];
      nums[i] = nums[child];
      nums[child] = tmp;
    }
  }
}
```

1. å»ºç«‹å †çš„è¿‡ç¨‹, ä»length/2 ä¸€ç›´å¤„ç†åˆ°0, æ—¶é—´å¤æ‚åº¦ä¸ºO(n);
2. è°ƒæ•´å †çš„è¿‡ç¨‹æ˜¯æ²¿ç€å †çš„çˆ¶å­èŠ‚ç‚¹è¿›è¡Œè°ƒæ•´, æ‰§è¡Œæ¬¡æ•°ä¸ºå †çš„æ·±åº¦, æ—¶é—´å¤æ‚åº¦ä¸ºO(lgn);
3. å †æ’åºçš„è¿‡ç¨‹ç”±næ¬¡ç¬¬2æ­¥å®Œæˆ, æ—¶é—´å¤æ‚åº¦ä¸ºO(nlgn).

| å¹³å‡æ—¶é—´å¤æ‚åº¦     | æœ€å¥½æƒ…å†µ           | æœ€åæƒ…å†µ           | ç©ºé—´å¤æ‚åº¦ | ç¨³å®šæ€§ |
| ------------------ | ------------------ | ------------------ | ---------- | ------ |
| ğ‘‚(ğ‘›log2ğ‘›)O(nlog2â¡n) | ğ‘‚(ğ‘›log2ğ‘›)O(nlog2â¡n) | ğ‘‚(ğ‘›log2ğ‘›)O(nlog2â¡n) | ğ‘‚(1)O(1)   | ä¸ç¨³å®š |

## åŸºæ•°æ’åº

### ç®—æ³•æè¿°

ä»æœ€ä½ä½å¼€å§‹ï¼Œå…·ä½“ç®—æ³•æè¿°å¦‚ä¸‹ï¼š

1. å–å¾—æ•°ç»„ä¸­çš„æœ€å¤§æ•°ï¼Œå¹¶å–å¾—ä½æ•°ï¼›
2. arrä¸ºåŸå§‹æ•°ç»„ï¼Œä»æœ€ä½ä½å¼€å§‹å–æ¯ä¸ªä½ç»„æˆradixæ•°ç»„ï¼›
3. å¯¹radixè¿›è¡Œè®¡æ•°æ’åºï¼ˆåˆ©ç”¨è®¡æ•°æ’åºé€‚ç”¨äºå°èŒƒå›´æ•°çš„ç‰¹ç‚¹ï¼‰ï¼›

```java
public int[] sortArray(int[] nums) {
        sort(nums);
        return nums;
    }
    public static void sort(int[] arr) {
    if (arr.length <= 1) return;

    //å–å¾—æ•°ç»„ä¸­çš„æœ€å¤§æ•°ï¼Œå¹¶å–å¾—ä½æ•°
    int max = 0;
    for (int i = 0; i < arr.length; i++) {
        if (max < arr[i]) {
            max = arr[i];
        }
    }
    int maxDigit = 1;
    while (max / 10 > 0) {
        maxDigit++;
        max = max / 10;
    }
    //ç”³è¯·ä¸€ä¸ªæ¡¶ç©ºé—´
    int[][] buckets = new int[10][arr.length];
    int base = 10;

    //ä»ä½ä½åˆ°é«˜ä½ï¼Œå¯¹æ¯ä¸€ä½éå†ï¼Œå°†æ‰€æœ‰å…ƒç´ åˆ†é…åˆ°æ¡¶ä¸­
    for (int i = 0; i < maxDigit; i++) {
        int[] bktLen = new int[10];        //å­˜å‚¨å„ä¸ªæ¡¶ä¸­å­˜å‚¨å…ƒç´ çš„æ•°é‡

        //åˆ†é…ï¼šå°†æ‰€æœ‰å…ƒç´ åˆ†é…åˆ°æ¡¶ä¸­
        for (int j = 0; j < arr.length; j++) {
            int whichBucket = (arr[j] % base) / (base / 10);
            buckets[whichBucket][bktLen[whichBucket]] = arr[j];
            bktLen[whichBucket]++;
        }

        //æ”¶é›†ï¼šå°†ä¸åŒæ¡¶é‡Œæ•°æ®æŒ¨ä¸ªæå‡ºæ¥,ä¸ºä¸‹ä¸€è½®é«˜ä½æ’åºåšå‡†å¤‡,ç”±äºé è¿‘æ¡¶åº•çš„å…ƒç´ æ’åé å‰,å› æ­¤ä»æ¡¶åº•å…ˆæã€‚
        // ä»¥ä¸ªä½æ•°ä¸ºä¾‹ï¼Œä¸ªä½æ•°è¶Šå¤§ï¼ŒåŠ å…¥arrçš„æ—¶é—´å°±è¶Šè¿Ÿã€‚é‚£ä¹ˆåœ¨ä¹‹ååˆ¤æ–­åä½æ•°çš„æ—¶å€™ï¼Œä¹Ÿä¼šè¾ƒè¿Ÿçš„åŠ å…¥arrä¸­ï¼Œå› æ­¤è€Œäº§ç”Ÿç›¸åŒåä½æ•°ï¼Œä¸ªä½æ•°çš„ä¸åŒ
        int k = 0;
        for (int b = 0; b < buckets.length; b++) {
            for (int p = 0; p < bktLen[b]; p++) {
                arr[k++] = buckets[b][p];
            }
        }
        System.out.println("Sorting: " + Arrays.toString(arr));
        base *= 10;
    }
}
```

ä»¥ä¸‹æ˜¯åŸºæ•°æ’åºç®—æ³•å¤æ‚åº¦ï¼Œå…¶ä¸­kä¸ºæœ€å¤§æ•°çš„ä½æ•°ï¼š

| å¹³å‡æ—¶é—´å¤æ‚åº¦ | æœ€å¥½æƒ…å†µ   | æœ€åæƒ…å†µ   | ç©ºé—´å¤æ‚åº¦ | ç¨³å®šæ€§ |
| -------------- | ---------- | ---------- | ---------- | ------ |
| O(d*(n+r))     | O(d*(n+r)) | O(d*(n+r)) | O(n+r)     | ç¨³å®š   |

å…¶ä¸­ï¼Œ**d ä¸ºä½æ•°ï¼Œr ä¸ºåŸºæ•°ï¼Œn ä¸ºåŸæ•°ç»„ä¸ªæ•°**ã€‚åœ¨åŸºæ•°æ’åºä¸­ï¼Œå› ä¸ºæ²¡æœ‰æ¯”è¾ƒæ“ä½œï¼Œæ‰€ä»¥åœ¨å¤æ‚ä¸Šï¼Œæœ€å¥½çš„æƒ…å†µä¸æœ€åçš„æƒ…å†µåœ¨æ—¶é—´ä¸Šæ˜¯ä¸€è‡´çš„ï¼Œå‡ä¸º `O(d*(n + r))`ã€‚

## å¸Œå°”æ’åº

### ç®—æ³•æè¿°

1. é€‰æ‹©ä¸€ä¸ªå¢é‡åºåˆ— t1ï¼Œt2ï¼Œâ€¦â€¦ï¼Œtkï¼Œå…¶ä¸­ ti > tj, tk = 1ï¼›
2. æŒ‰å¢é‡åºåˆ—ä¸ªæ•° kï¼Œå¯¹åºåˆ—è¿›è¡Œ k è¶Ÿæ’åºï¼›
3. æ¯è¶Ÿæ’åºï¼Œæ ¹æ®å¯¹åº”çš„å¢é‡ tiï¼Œå°†å¾…æ’åºåˆ—åˆ†å‰²æˆè‹¥å¹²é•¿åº¦ä¸º m çš„å­åºåˆ—ï¼Œåˆ†åˆ«å¯¹å„å­è¡¨è¿›è¡Œç›´æ¥æ’å…¥æ’åºã€‚ä»…å¢é‡å› å­ä¸º 1 æ—¶ï¼Œæ•´ä¸ªåºåˆ—ä½œä¸ºä¸€ä¸ªè¡¨æ¥å¤„ç†ï¼Œè¡¨é•¿åº¦å³ä¸ºæ•´ä¸ªåºåˆ—çš„é•¿åº¦ã€‚

æ•ˆæœå¦‚ä¸‹ï¼š

![img](https://gitee.com/super-jimwang/img/raw/master/img/20210218202425.png)

```java
public static void sort(int[] a) {
    int length = a.length;
    int h = 1;
    while (h < length / 3) h = 3 * h + 1;
    for (; h >= 1; h /= 3) {
        for (int i = 0; i < a.length - h; i += h) {
            for (int j = i + h; j > 0; j -= h) {
                if (a[j] < a[j - h]) {
                    int temp = a[j];
                    a[j] = a[j - h];
                    a[j - h] = temp;
                }
            }
        }
    }
}
```

ä»¥ä¸‹æ˜¯å¸Œå°”æ’åºå¤æ‚åº¦:

| å¹³å‡æ—¶é—´å¤æ‚åº¦ | æœ€å¥½æƒ…å†µ   | æœ€åæƒ…å†µ   | ç©ºé—´å¤æ‚åº¦ | ç¨³å®šæ€§ |
| -------------- | ---------- | ---------- | ---------- | ------ |
| O(nlog2 n)     | O(nlog2 n) | O(nlog2 n) | O(1)       | ä¸ç¨³å®š |

## åº”ç”¨åœºæ™¯

- **å†’æ³¡æ’åºï¼š**ä¼˜åŒ–åçš„å†’æ³¡æ’åºå¯ç”¨äºå½“æ•°æ®å·²ç»åŸºæœ¬æœ‰åºï¼Œä¸”æ•°æ®é‡è¾ƒå°æ—¶ï¼›
- **æ’å…¥æ’åºï¼š**è‹¥æ•°ç»„åŸºæœ¬æœ‰åºä¸”æ•°æ®è§„æ¨¡è¾ƒå°æ—¶ï¼Œé€‰ç”¨æ’å…¥æ’åºè¾ƒå¥½ï¼›
- **å¸Œå°”æ’åºï¼š**æ•°æ®é‡è¾ƒå°ä¸”åŸºæœ¬æœ‰åºæ—¶ï¼›
- **é€‰æ‹©æ’åºï¼š**å½“æ•°æ®è§„æ¨¡è¾ƒå°æ—¶ï¼Œé€‰æ‹©æ’åºæ€§èƒ½è¾ƒå¥½ï¼›
- **å †æ’åºï¼š**å †æ’åºé€‚åˆå¤„ç†æ•°æ®é‡å¤§çš„æƒ…å†µï¼Œæ•°æ®å‘ˆæµå¼è¾“å…¥æ—¶ç”¨å †æ’åºä¹Ÿå¾ˆæ–¹ä¾¿ï¼›
- **å½’å¹¶æ’åºï¼š**æ•°æ®é‡è¾ƒå¤§ä¸”è¦æ±‚æ’åºç¨³å®šæ—¶ï¼›
- **å¿«é€Ÿæ’åºï¼š**å¿«é€Ÿæ’åºé€‚åˆå¤„ç†å¤§é‡æ•°æ®æ’åºæ—¶çš„åœºæ™¯ï¼›
- **åŸºæ•°æ’åºï¼š**åŸºæ•°æ’åºè™½ç„¶æ—¶é—´å¤æ‚åº¦è¾ƒä½ï¼Œä½†éœ€è¦æ»¡è¶³çš„æ¡ä»¶è¾ƒå¤šï¼Œå¦‚æœèƒ½æ»¡è¶³é™åˆ¶æ¡ä»¶ä¸ç©ºé—´éœ€æ±‚ï¼ŒåŸºæ•°æ’åºè‡ªç„¶å¾ˆå¿«ã€‚



- è‹¥nè¾ƒå°(å¦‚nâ‰¤50)ï¼Œå¯é‡‡ç”¨ç›´æ¥æ’å…¥æˆ–ç›´æ¥é€‰æ‹©æ’åºã€‚
  - è‹¥åºåˆ—åˆå§‹çŠ¶æ€åŸºæœ¬æœ‰åºï¼Œåˆ™ç›´æ¥æ’å…¥å’Œå†’æ³¡æœ€ä½³ï¼Œéšæœºçš„å¿«é€Ÿæ’åºä¹Ÿä¸é”™ã€‚æ’å…¥æ’åºå¯¹éƒ¨åˆ†æœ‰åºçš„æ•°ç»„å¾ˆæœ‰æ•ˆï¼Œæ‰€éœ€çš„æ¯”è¾ƒæ¬¡æ•°å¹³å‡åªæœ‰é€‰æ‹©æ’åºçš„ä¸€åŠã€‚
  - è‹¥nè¾ƒå¤§ï¼Œåˆ™åº”é‡‡ç”¨æ—¶é—´å¤æ‚åº¦ä¸º**O(nlgn)**çš„æ’åºæ–¹æ³•**ï¼šå¿«é€Ÿæ’åºã€å †æ’åºæˆ–å½’å¹¶æ’åº**ã€‚å½’å¹¶æ’åºå¯ä»¥å¤„ç†æ•°ç™¾ä¸‡ç”šè‡³æ›´å¤§è§„æ¨¡çš„æ•°ç»„ï¼Œä½†æ˜¯æ’å…¥å’Œé€‰æ‹©åšä¸åˆ°ã€‚å½’å¹¶æ’åºçš„ä¸»è¦ç¼ºç‚¹æ˜¯è¾…åŠ©æ•°ç»„æ‰€ä½¿ç”¨çš„é¢å¤–ç©ºé—´å’Œnçš„å¤§å°æˆæ­£æ¯”ã€‚
    - å¿«é€Ÿæ’åºæ˜¯ç›®å‰åŸºäºæ¯”è¾ƒçš„å†…éƒ¨æ’åºä¸­è¢«è®¤ä¸ºæ˜¯æœ€å¥½çš„æ–¹æ³•ï¼Œå½“å¾…æ’åºçš„å…³é”®å­—æ˜¯éšæœºåˆ†å¸ƒæ—¶ï¼Œå¿«é€Ÿæ’åºçš„å¹³å‡æ—¶é—´æœ€çŸ­ï¼›
    - å †æ’åºæ‰€éœ€çš„è¾…åŠ©ç©ºé—´å°‘äºå¿«é€Ÿæ’åºï¼Œå¹¶ä¸”ä¸ä¼šå‡ºç°å¿«é€Ÿæ’åºå¯èƒ½å‡ºç°çš„æœ€åæƒ…å†µã€‚ä½†è¿™ä¸¤ç§æ’åºéƒ½æ˜¯ä¸ç¨³å®šçš„ã€‚
    - è‹¥è¦æ±‚æ’åºç¨³å®šï¼Œåˆ™å¯é€‰ç”¨å½’å¹¶æ’åºã€‚ä¸¤ä¸¤å½’å¹¶çš„æ’åºç®—æ³•å¹¶ä¸å€¼å¾—æå€¡ï¼Œé€šå¸¸å¯ä»¥å°†å®ƒå’Œç›´æ¥æ’å…¥æ’åºç»“åˆåœ¨ä¸€èµ·ä½¿ç”¨ã€‚å…ˆåˆ©ç”¨ç›´æ¥æ’å…¥æ’åºæ±‚å¾—è¾ƒé•¿çš„æœ‰åºå­æ–‡ä»¶ï¼Œç„¶åå†ä¸¤ä¸¤å½’å¹¶ä¹‹ã€‚å› ä¸ºç›´æ¥æ’å…¥æ’åºæ˜¯ç¨³å®šçš„ï¼Œæ‰€ä»¥æ”¹è¿›åçš„å½’å¹¶æ’åºä»æ˜¯ç¨³å®šçš„ã€‚
  - å¿«é€Ÿæ’åºçš„ä¼˜ç‚¹æ˜¯åŸåœ°æ’åºï¼ˆåªéœ€è¦ä¸€ä¸ªå¾ˆå°çš„è¾…åŠ©æ ˆï¼‰ï¼Œä½†æ˜¯åŸºå‡†çš„é€‰å–æ˜¯ä¸ªé—®é¢˜ï¼Œå¯¹äºå°æ•°ç»„ï¼Œå¿«é€Ÿæ’åºè¦æ¯”æ’å…¥æ’åºæ…¢ã€‚
  - å †æ’åºçš„ä¼˜ç‚¹æ˜¯åœ¨æ’åºæ—¶å¯ä»¥å°†éœ€è¦æ’åºçš„æ•°ç»„æœ¬èº«ä½œä¸ºå †ï¼Œæ— éœ€ä»»ä½•é¢å¤–ç©ºé—´ï¼Œä¸é€‰æ‹©æ’åºæœ‰äº›ç±»ä¼¼ï¼Œä½†æ‰€éœ€çš„æ¯”è¾ƒè¦å°‘å¾—å¤šï¼Œå †æ’åºé€‚åˆä¾‹å¦‚åµŒå…¥å¼ç³»ç»Ÿæˆ–ä½æˆæœ¬ç§»åŠ¨è®¾å¤‡ä¸­å®¹é‡æœ‰é™çš„åœºæ™¯ã€‚


> ç©ºé—´å¤æ‚åº¦æœ€å¤§çš„æ’åºç®—æ³•

å †æ’åº O(n+r)ï¼Œræ˜¯åŸºæ•°ã€‚ä¹Ÿå°±æ˜¯10


# è·³è¡¨
> ä»€ä¹ˆæ˜¯è·³è¡¨

å¤šå±‚çš„æœ‰åºé“¾è¡¨ï¼Œè¶Šä¸Šå±‚ï¼ŒèŠ‚ç‚¹æ•°è¶Šå°‘
![](https://gitee.com/super-jimwang/img/raw/master/img/20210306215440.png)

> è·³è¡¨å¦‚ä½•æŸ¥è¯¢

ä»æœ€ä¸Šé¢é‚£å±‚å¼€å§‹ï¼Œä»å·¦å¾€å³éå†ï¼Œç›´åˆ°ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æ¯”è¦æŸ¥è¯¢çš„å€¼å¤§ï¼Œå¾€ä¸‹ä¸€å±‚èµ°ã€‚å¾ªç¯ã€‚

![](https://gitee.com/super-jimwang/img/raw/master/img/20210306215532.png)

> è·³è¡¨çš„å®ç°ç»“æ„

![](https://gitee.com/super-jimwang/img/raw/master/img/20210306215550.png)

> ä¸ºä»€ä¹ˆç”¨è·³è¡¨è€Œä¸ç”¨çº¢é»‘æ ‘

è·³è¡¨çš„å¤æ‚åº¦å’Œçº¢é»‘æ ‘ä¸€æ ·éƒ½æ˜¯O(lgn)

ä½†æ˜¯å¹¶å‘æ¡ä»¶ä¸‹ï¼Œçº¢é»‘æ ‘æ’å…¥å’Œåˆ é™¤æ—¶ï¼Œå¯èƒ½éœ€è¦rebalanceæ•´æ£µæ ‘ï¼Œè€Œè·³è¡¨æ›´åŠ å±€éƒ¨ã€‚

# çº¢é»‘æ ‘ã€å“ˆå¸Œè¡¨ã€å †

## çº¢é»‘æ ‘

çº¢é»‘æ ‘çš„æ¯ä¸ªèŠ‚ç‚¹ä¸Šéƒ½æœ‰å­˜å‚¨ä½è¡¨ç¤ºèŠ‚ç‚¹çš„é¢œè‰²ï¼Œå¯ä»¥æ˜¯çº¢(Red)æˆ–é»‘(Black)ã€‚

**çº¢é»‘æ ‘çš„ç‰¹æ€§**:
**ï¼ˆ1ï¼‰æ¯ä¸ªèŠ‚ç‚¹æˆ–è€…æ˜¯é»‘è‰²ï¼Œæˆ–è€…æ˜¯çº¢è‰²ã€‚**
**ï¼ˆ2ï¼‰æ ¹èŠ‚ç‚¹æ˜¯é»‘è‰²ã€‚**
**ï¼ˆ3ï¼‰æ¯ä¸ªå¶å­èŠ‚ç‚¹ï¼ˆNILï¼‰æ˜¯é»‘è‰²ã€‚ [æ³¨æ„ï¼šè¿™é‡Œå¶å­èŠ‚ç‚¹ï¼Œæ˜¯æŒ‡ä¸ºç©º(NILæˆ–NULL)çš„å¶å­èŠ‚ç‚¹ï¼]**
**ï¼ˆ4ï¼‰å¦‚æœä¸€ä¸ªèŠ‚ç‚¹æ˜¯çº¢è‰²çš„ï¼Œåˆ™å®ƒçš„å­èŠ‚ç‚¹å¿…é¡»æ˜¯é»‘è‰²çš„ã€‚**
**ï¼ˆ5ï¼‰==ä»ä¸€ä¸ªèŠ‚ç‚¹åˆ°è¯¥èŠ‚ç‚¹çš„å­å­™èŠ‚ç‚¹çš„æ‰€æœ‰è·¯å¾„ä¸ŠåŒ…å«ç›¸åŒæ•°ç›®çš„é»‘èŠ‚ç‚¹ã€‚==**

**æ³¨æ„**ï¼š
(01) ç‰¹æ€§(3)ä¸­çš„å¶å­èŠ‚ç‚¹ï¼Œæ˜¯åªä¸ºç©º(NILæˆ–null)çš„èŠ‚ç‚¹ã€‚
(02) ç‰¹æ€§(5)ï¼Œç¡®ä¿æ²¡æœ‰ä¸€æ¡è·¯å¾„ä¼šæ¯”å…¶ä»–è·¯å¾„é•¿å‡ºä¿©å€ã€‚==å› è€Œï¼Œçº¢é»‘æ ‘æ˜¯ç›¸å¯¹æ˜¯æ¥è¿‘å¹³è¡¡çš„äºŒå‰æ ‘ã€‚==

![image-20210216221031160](https://gitee.com/super-jimwang/img/raw/master/img/20210216221031.png)

### åº”ç”¨

çº¢é»‘æ ‘ä¸»è¦æ˜¯ç”¨æ¥å­˜å‚¨æœ‰åºçš„æ•°æ®çš„

### æ•°æ®

**çº¢é»‘æ ‘çš„æ—¶é—´å¤æ‚åº¦ä¸º: O(lgn)**

**ä¸€æ£µå«æœ‰nä¸ªèŠ‚ç‚¹çš„çº¢é»‘æ ‘çš„é«˜åº¦è‡³å¤šä¸º2log(n+1)**.

### æ“ä½œ
https://blog.csdn.net/wuzhenwei0419/article/details/84554049
#### çº¢é»‘æ ‘çš„å·¦æ—‹
![](https://gitee.com/super-jimwang/img/raw/master/img/20210330212100.png)

```java
/**
    * å·¦æ—‹
    */
static <K,V> TreeNode<K,V> rotateLeft(TreeNode<K,V> root,
                                        TreeNode<K,V> p) {
    //è¿™é‡Œçš„på³ä¸Šå›¾çš„AèŠ‚ç‚¹ï¼ŒræŒ‡å‘å³å­©å­å³Cï¼ŒrlæŒ‡å‘å³å­©å­çš„å·¦å­©å­å³Dï¼Œppä¸ºpçš„çˆ¶èŠ‚ç‚¹
    TreeNode<K,V> r, pp, rl;
    if (p != null && (r = p.right) != null) {
        if ((rl = p.right = r.left) != null)
            rl.parent = p;
        //å°†pçš„çˆ¶èŠ‚ç‚¹çš„å­©å­èŠ‚ç‚¹æŒ‡å‘r
        // å¦‚æœAå°±æ˜¯æ ¹èŠ‚ç‚¹ï¼Œé‚£ä¹ˆCæ¢ä¸Šæ¥ä¹‹åï¼Œè¦æŠŠå®ƒå˜æˆé»‘è‰²ï¼Œå› ä¸ºæ ¹èŠ‚ç‚¹éƒ½æ˜¯é»‘è‰²çš„
        if ((pp = r.parent = p.parent) == null)
            (root = r).red = false;
        else if (pp.left == p)
            pp.left = r;
        else
            pp.right = r;
        //å°†pç½®ä¸ºrçš„å·¦èŠ‚ç‚¹
        r.left = p;
        p.parent = r;
    }
    return root;
}
```

#### çº¢é»‘æ ‘çš„å³æ—‹
![](https://gitee.com/super-jimwang/img/raw/master/img/20210330212509.png)

```java
/**
* å³æ—‹
*/
static <K,V> TreeNode<K,V> rotateRight(TreeNode<K,V> root,
                                        TreeNode<K,V> p) {
        //è¿™é‡Œçš„på³ä¸Šå›¾çš„AèŠ‚ç‚¹ï¼ŒlæŒ‡å‘å·¦å­©å­å³Cï¼ŒlræŒ‡å‘å·¦å­©å­çš„å³å­©å­å³Eï¼Œppä¸ºpçš„çˆ¶èŠ‚ç‚¹
    TreeNode<K,V> l, pp, lr;
    if (p != null && (l = p.left) != null) {
        if ((lr = p.left = l.right) != null)
            lr.parent = p;
        if ((pp = l.parent = p.parent) == null)
            (root = l).red = false;
        else if (pp.right == p)
            pp.right = l;
        else
            pp.left = l;
        l.right = p;
        p.parent = l;
    }
    return root;
}
```



## å“ˆå¸Œè¡¨

é€šè¿‡å“ˆå¸Œå‡½æ•°å°†keyè¿›è¡Œæ˜ å°„ã€‚

### å¦‚ä½•è§£å†³å“ˆå¸Œå†²çª

#### å¼€æ”¾åœ°å€

å¦‚æœè¯¥åœ°å€å·²ç»å­˜äº†ï¼Œé‚£å°±å¾€åç»§ç»­æ¢æµ‹ï¼Œç›´åˆ°æ‰¾åˆ°ç©ºåœ°å€ä½ç½®ï¼Œå­˜å…¥æ•°æ®ã€‚

åœ¨æŸ¥è¯¢çš„æ—¶å€™ï¼Œå¦‚æœkeyå¯¹ä¸ä¸Šï¼Œåˆ™æŒ‰ç›¸åŒçš„è§„åˆ™ç»§ç»­æ¢æµ‹ã€‚

### é“¾è¡¨æ³•

å¦‚æœåœ°å€å†²çªäº†ï¼ŒæŠŠæ•°æ®å½“ä½œé“¾è¡¨è¿æ¥èµ·æ¥ï¼Œå­˜åœ¨åŒä¸€ä¸ªåœ°å€å†…ã€‚

æŸ¥è¯¢çš„æ—¶å€™éœ€è¦éå†é“¾è¡¨



## å †

å †å°±æ˜¯ä»¥äºŒå‰æ ‘çš„å½¢å¼æ¥ç»´æŠ¤ä¸€ä¸ªæ•°ç»„ã€‚

åˆ†ä¸ºå¤§æ ¹å †å’Œå°æ ¹å †ã€‚å¤§æ ¹å †çˆ¶èŠ‚ç‚¹æ¯”å­èŠ‚ç‚¹è¦å¤§ã€‚


# äºŒå‰æ ‘çš„éå†

## å‰åºéå†

```java
public List<Integer> ans = new ArrayList<>();
public List<Integer> preorderTraversal(TreeNode root){
  preorder(root);
  return ans;
}

public void preorder(TreeNode node) {
  if(node == null) return;
  ans.add(node.val);
  preorder(node.left);
  preorder(node.right);
}
```

## ä¸­åºéå†

```java
public List<Integer> ans = new ArrayList<>();
public List<Integer> inorderTraversal(TreeNode root){
  inorder(root);
  return ans;
}

public void inorder(TreeNode node) {
  if(node == null) return;
  inorder(node.left);
  ans.add(node.val);
  inorder(node.right);
}
```

## ååºéå†

```java
public List<Integer> ans = new ArrayList<>();
public List<Integer> postorderTraversal(TreeNode root){
  postorder(root);
  return ans;
}

public void postorder(TreeNode node) {
  if(node == null) return;
  postorder(node.left);
  postorder(node.right);
  ans.add(node.val);
}
```
